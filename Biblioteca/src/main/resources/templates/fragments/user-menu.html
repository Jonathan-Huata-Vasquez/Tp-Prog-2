<!-- Fragmento reutilizable del menú de usuario -->
<!-- Parámetros: iniciales, nombreCompleto, roleLabel, perfilPath -->
<th:block th:fragment="userMenu(iniciales, nombreCompleto, roleLabel, perfilPath)">
    <details class="user-menu ms-2">
        <summary class="d-flex align-items-center gap-2">
            <span class="user-avatar" th:text="${iniciales ?: 'US'}">US</span>
        </summary>
        <div class="user-menu-dropdown">
            <!-- Encabezado con nombre y rol -->
            <div class="user-menu-header">
                <div class="user-menu-name" th:text="${nombreCompleto ?: 'Usuario'}">
                    Usuario
                </div>

                <div class="user-menu-role" th:text="${'Rol: ' + (roleLabel ?: 'N/D')}">
                    Rol: N/D
                </div>
            </div>

            <div class="user-menu-divider"></div>

            <!-- Link a perfil -->
            <a class="user-menu-link" th:href="${perfilPath}">
                <i class="bi bi-person-badge"></i>
                <span>Perfil</span>
            </a>

            <!-- Cerrar sesión -->
            <form class="user-menu-form" th:action="@{/logout}" method="post">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

                <button type="submit" class="user-menu-link user-menu-logout-btn">
                    <i class="bi bi-box-arrow-right"></i>
                    <span>Cerrar sesión</span>
                </button>
            </form>
        </div>

    </details>
</th:block>