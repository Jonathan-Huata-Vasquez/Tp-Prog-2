<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<body>

<!-- Fragment de tabla de préstamos reutilizable -->
<div th:fragment="tablaPrestamos(prestamos, mostrarLector)" class="table-responsive">
    <table class="table table-dark-custom table-striped table-hover align-middle mb-0">
        <thead>
        <tr>
            <th scope="col" th:if="${mostrarLector}">Lector</th>
            <th scope="col">Libro</th>
            <th scope="col">Ejemplar</th>
            <th scope="col">Fecha préstamo</th>
            <th scope="col">Fecha vencimiento</th>
            <th scope="col">Estado</th>
            <th scope="col" class="text-end" th:if="${!mostrarLector}">Consulta</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="prestamo : ${prestamos}">
            <td th:if="${mostrarLector}">
                <div class="fw-semibold" th:text="${prestamo.nombreLector}">Nombre Lector</div>
                <div class="small text-soft-muted" th:text="${'ID Lector: ' + prestamo.idLector}">ID Lector</div>
            </td>
            <td>
                <div class="fw-semibold" th:text="${prestamo.tituloLibro}">Título</div>
                <div class="small text-soft-muted" th:text="${prestamo.autorNombre ?: 'Autor'}">Autor</div>
            </td>
            <td>
                <span class="small text-soft-muted" th:text="${'Ejemplar #' + prestamo.idEjemplar}">Ejemplar #</span>
            </td>
            <td>
                <span class="small" th:text="${prestamo.fechaPrestamo}">01/01/2025</span>
            </td>
            <td>
                <span class="small" th:text="${prestamo.fechaVencimiento}">21/01/2025</span>
            </td>
            <td>
                <span th:switch="${prestamo.estado}">
                    <span th:case="'ACTIVO'" class="badge badge-estado badge-estado-activo">Activo</span>
                    <span th:case="'VENCIDO'" class="badge badge-estado badge-estado-vencido">Vencido</span>
                    <span th:case="'DEVUELTO'" class="badge badge-estado badge-estado-devuelto">Devuelto</span>
                    <span th:case="*" class="badge badge-estado badge-estado-devuelto">—</span>
                </span>
            </td>
            <td class="text-end" th:if="${!mostrarLector}">
                <a class="btn btn-outline-secondary btn-sm" th:href="@{/prestamos/{id}(id=${prestamo.idPrestamo})}">
                    <i class="bi bi-file-text me-1"></i>
                    Ver préstamo
                </a>
            </td>
        </tr>

        <tr th:if="${prestamos == null or #lists.isEmpty(prestamos)}">
            <td th:colspan="${mostrarLector ? 6 : 7}" class="text-center text-soft-muted small">
                No hay préstamos para mostrar.
            </td>
        </tr>
        </tbody>
    </table>
</div>

</body>
</html>