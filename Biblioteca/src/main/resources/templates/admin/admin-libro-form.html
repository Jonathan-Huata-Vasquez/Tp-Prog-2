<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head(titulo='Nuevo Libro - Administración')}"><title>Nuevo Libro - Administración</title></head>
<body>
<div th:replace="~{fragments/navbar-admin :: navbarAdmin('libros')}"></div>

<main class="container">
    <section class="row g-4 mt-4" aria-label="Formulario nuevo libro">

        <!-- Encabezado -->
        <div class="col-12">
            <div class="card card-soft mb-3">
                <div class="card-body d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-3">
                    <div>
                        <p class="section-title mb-1">Libros</p>
                        <h1 class="h4 mb-2" th:text="${libro?.id != null} ? 'Editar libro' : 'Nuevo libro'">Nuevo libro</h1>
                        <p class="mb-0 text-soft-muted">
                            Cargá los datos principales del libro para que pueda formar parte del catálogo de la biblioteca.
                        </p>
                    </div>
                    <div class="text-md-end">
                        <a th:href="@{/admin/libros}" class="btn btn-outline-secondary btn-sm">
                            <i class="bi bi-arrow-left me-1"></i>
                            Volver al listado
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Formulario principal -->
        <div class="col-lg-8">
            <div class="card card-soft">
                <div class="card-body">
                    <p class="section-title mb-3">Datos del libro</p>

                    <!-- FORM -->

                    <form th:action="@{/admin/libros}" th:object="${libroForm}" method="post" class="row g-3">
                        <!-- Título -->
                        <div class="col-12">
                            <label for="titulo" class="small-label mb-1">Título</label>
                            <input type="text" id="titulo" th:field="*{titulo}" class="form-control" placeholder="Ej: Cien años de soledad" required>
                            <div class="form-text text-soft-muted mt-1 small">
                                Es el título tal como aparece en la tapa del libro.
                            </div>
                        </div>

                        <!-- Autor -->
                        <div class="col-12 col-md-6 field-group">
                            <label for="autorId" class="small-label mb-1">Autor</label>
                            <select id="autorId" th:field="*{idAutor}" class="form-select form-select-pill" required>
                                <option value="" disabled th:selected="*{idAutor} == null">Seleccioná un autor</option>
                                <option th:each="autor : ${autores}" th:value="${autor.id}" th:text="${autor.nombre}" th:selected="*{idAutor} == ${autor.id}">Autor</option>
                            </select>
                            <div class="form-text text-soft-muted mt-1 small">
                                Si el autor no existe todavía, podés crearlo desde la sección Autores.
                            </div>
                        </div>

                        <!-- Editorial -->
                        <div class="col-12 col-md-6 field-group">
                            <label for="editorialId" class="small-label mb-1">Editorial</label>
                            <select id="editorialId" th:field="*{idEditorial}" class="form-select form-select-pill" required>
                                <option value="" disabled th:selected="*{idEditorial} == null">Seleccioná una editorial</option>
                                <option th:each="edit : ${editoriales}" th:value="${edit.id}" th:text="${edit.nombre}" th:selected="*{idEditorial} == ${edit.id}">Editorial</option>
                            </select>
                            <div class="form-text text-soft-muted mt-1 small">
                                Corresponde a la casa editorial que publicó el libro.
                            </div>
                        </div>

                        <!-- Año + Categoría -->
                        <div class="col-12 col-md-4 field-group">
                            <label for="anioPublicacion" class="small-label mb-1">Año de publicación</label>
                            <input type="number" id="anioPublicacion" th:field="*{anioPublicacion}" class="form-control" placeholder="Ej: 1967" min="1000" max="2100">
                        </div>

                        <div class="col-12 col-md-8 field-group">
                            <label for="categoria" class="small-label mb-1">Categoría</label>
                            <select id="categoria" th:field="*{categoria}" class="form-select form-select-pill" required>
                                <option value="" disabled th:selected="*{categoria} == null">Seleccioná una categoría</option>
                                <option th:each="cat : ${categorias}" th:value="${cat}" th:text="${cat}" th:selected="*{categoria} == ${cat}">Categoría</option>
                            </select>
                            <div class="form-text text-soft-muted mt-1 small">
                                Usá siempre los mismos criterios de categorías para mantener el catálogo ordenado.
                            </div>
                        </div>

                        <!-- Descripción -->
                        <div class="col-12">
                            <label for="descripcion" class="small-label mb-1">Descripción</label>
                            <textarea id="descripcion" th:field="*{descripcion}" class="form-control" placeholder="Breve reseña o descripción del contenido del libro..."></textarea>
                            <div class="form-text text-soft-muted mt-1 small">
                                Este texto puede ayudar a los lectores a entender de qué trata el libro antes de pedirlo.
                            </div>
                        </div>

                        <div class="divider-soft"></div>

                        <!-- Botones -->
                        <div class="col-12 d-flex flex-wrap gap-2">
                            <button type="submit" class="btn btn-primary" aria-label="Guardar libro">
                                <i class="bi bi-check2-circle me-1" aria-hidden="true"></i>
                                <span th:text="${libro?.id != null} ? 'Guardar cambios' : 'Crear libro'">Crear libro</span>
                            </button>

                            <a th:href="@{/admin/libros}" class="btn btn-outline-secondary">
                                <i class="bi bi-x-lg me-1"></i>
                                Cancelar
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Columna derecha: sugerencias -->
        <div class="col-lg-4">
            <div class="card card-soft-light">
                <div class="card-body">
                    <p class="section-title mb-2">Sugerencias</p>
                    <ul class="list-unstyled small text-soft-muted mb-0">
                        <li>• Revisá que el título y el autor estén escritos sin errores ortográficos.</li>
                        <li>• Usá la misma forma de escribir nombres de autores y editoriales en todos los libros.</li>
                        <li>• Si no estás seguro del año de publicación, podés dejarlo vacío o completarlo más adelante.</li>
                        <li>• La descripción no es obligatoria, pero mejora mucho la experiencia de los lectores.</li>
                    </ul>
                </div>
            </div>
        </div>

    </section>
</main>

</body>
</html>
